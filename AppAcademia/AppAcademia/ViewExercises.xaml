<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="AppAcademia.ViewExercises"
             Title="ViewExercises">
    <ScrollView>
        <VerticalStackLayout Padding="15"
                             Spacing="15">
            <Label Text="Meus ExercÃ­cios"
                   FontSize="28"
                   FontAttributes="Bold"
                   HorizontalOptions="Center"
                   TextColor="{AppThemeBinding Light={StaticResource Magenta}, Dark={StaticResource White}}"
                   Margin="0,10,0,10"/>

            <Frame BackgroundColor="{AppThemeBinding Light={StaticResource Gray100}, Dark={StaticResource Gray600}}"
                   Padding="20"
                   Margin="0,0,0,5"
                   CornerRadius="12"
                   HasShadow="True">
                <VerticalStackLayout Spacing="10">
                    <HorizontalStackLayout HorizontalOptions="Center"
                                           Spacing="12">
                        <Label Text="ðŸ“Š"
                               FontSize="24"/>
                        <Label>
                            <Label.FormattedText>
                                <FormattedString>
                                    <Span Text="ExercÃ­cios realizados hoje: "
                                          FontSize="17"
                                          TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource Gray100}}"/>
                                    <Span x:Name="TodayCountLabel"
                                          Text="0"
                                          FontSize="22"
                                          FontAttributes="Bold"
                                          TextColor="{AppThemeBinding Light={StaticResource Magenta}, Dark={StaticResource White}}"/>
                                </FormattedString>
                            </Label.FormattedText>
                        </Label>
                    </HorizontalStackLayout>

                    <!-- Filtros por Data -->
                    <Grid ColumnDefinitions="*, Auto"
                            ColumnSpacing="10">
                        <DatePicker x:Name="FilterDatePicker"
                                    DateSelected="OnDateSelected"/>
                        <Button Grid.Column="1"
                                Text="Hoje"
                                Clicked="OnTodayClicked"
                                FontAttributes="Bold"
                                BackgroundColor="{AppThemeBinding Light={StaticResource Magenta}, Dark={StaticResource Gray900}}"
                                TextColor="{StaticResource White}"
                                CornerRadius="8"/>
                    </Grid>
                </VerticalStackLayout>
            </Frame>

            <CollectionView x:Name="ExercisesListView"
                            EmptyView="Nenhum exercÃ­cio cadastrado ainda.">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Frame Padding="18"
                               Margin="0,8"
                               BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource Gray950}}"
                               CornerRadius="12"
                               HasShadow="True">
                            <VerticalStackLayout Spacing="12">
                                <!-- TÃ­tulo do ExercÃ­cio -->
                                <Label Text="{Binding ExerciseType}"
                                       FontSize="20"
                                       FontAttributes="Bold"
                                       TextColor="{AppThemeBinding Light={StaticResource Magenta}, Dark={StaticResource White}}"/>

                                <!-- Box de InformaÃ§Ãµes Principais -->
                                <Frame BackgroundColor="{AppThemeBinding Light={StaticResource Gray100}, Dark={StaticResource Gray600}}"
                                       Padding="12"
                                       CornerRadius="8"
                                       HasShadow="False">
                                    <Grid ColumnDefinitions="*, *"
                                          RowDefinitions="Auto, Auto"
                                          ColumnSpacing="10"
                                          RowSpacing="8">

                                        <!-- RepetiÃ§Ãµes -->
                                        <VerticalStackLayout Grid.Column="0"
                                                Grid.Row="0">
                                            <Label Text="RepetiÃ§Ãµes"
                                                   FontSize="12"
                                                   TextColor="{AppThemeBinding Light={StaticResource Gray600}, Dark={StaticResource Gray200}}"
                                                   FontAttributes="Bold"/>
                                            <Label Text="{Binding Repetitions}"
                                                   FontSize="18"
                                                   FontAttributes="Bold"
                                                   TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource Gray100}}"/>
                                        </VerticalStackLayout>

                                        <!-- Carga -->
                                        <VerticalStackLayout Grid.Column="1"
                                                Grid.Row="0">
                                            <Label Text="Carga"
                                                   FontSize="12"
                                                   TextColor="{AppThemeBinding Light={StaticResource Gray600}, Dark={StaticResource Gray200}}"
                                                   FontAttributes="Bold"/>
                                            <Label Text="{Binding Load, StringFormat='{0:F1} kg'}"
                                                   FontSize="18"
                                                   FontAttributes="Bold"
                                                   TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource Gray100}}"/>
                                        </VerticalStackLayout>

                                        <!-- Data -->
                                        <VerticalStackLayout Grid.Column="0"
                                                Grid.Row="1"
                                                Grid.ColumnSpan="2">
                                            <Label Text="Data e Hora"
                                                   FontSize="12"
                                                   TextColor="{AppThemeBinding Light={StaticResource Gray600}, Dark={StaticResource Gray200}}"
                                                   FontAttributes="Bold"/>
                                            <Label Text="{Binding CreatedAt, StringFormat='{0:dd/MM/yyyy HH:mm}'}"
                                                   FontSize="15"
                                                   TextColor="{AppThemeBinding Light={StaticResource Gray600}, Dark={StaticResource Gray200}}"/>
                                        </VerticalStackLayout>
                                    </Grid>
                                </Frame>

                                <!-- Caminho da Foto -->
                                <Label FontSize="13"
                                       TextColor="{AppThemeBinding Light={StaticResource Gray500}, Dark={StaticResource Gray200}}"
                                       Padding="5,0">
                                    <Label.FormattedText>
                                        <FormattedString>
                                            <Span Text="ðŸ“· "
                                                    FontSize="14"/>
                                            <Span Text="Foto: "
                                                  FontAttributes="Bold"/>
                                            <Span Text="{Binding EquipmentPhotoPath}"/>
                                        </FormattedString>
                                    </Label.FormattedText>
                                    <Label.Triggers>
                                        <DataTrigger TargetType="Label"
                                                     Binding="{Binding EquipmentPhotoPath}"
                                                     Value="">
                                            <Setter Property="IsVisible"
                                                    Value="False"/>
                                        </DataTrigger>
                                    </Label.Triggers>
                                </Label>
                            </VerticalStackLayout>
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>